<!DOCTYPE html>
<html>
    <head>
        <title>Tetris</title>
        <style>
            #demo {
                text-align: center;
            }
        </style>
        <script>
            const FilledPositionsOnBoard_X = [];
            const FilledPositionsOnBoard_Y = [];
            //Narysowanie kwadratu
            const SquareX = [];
            const SquareY = [];
            SquareX[0] = 0;
            SquareY[0] = 0;
            SquareX[1] = 1;
            SquareY[1] = 0;
            SquareX[2] = 0;
            SquareY[2] = 1;
            SquareX[3] = 1;
            SquareY[3] = 1;
            let output = "";
            let postawiono = 0;
            const Board = [];
            for(let i = 0; i < 20; i++){
                Board[i] = [];
                for(let j = 0; j < 20; j++){
                    Board[i][j] = 0;
                }
            }
            function drawBoard(){
                //rysowanie postawionych figur
                for(let i = 0; i < FilledPositionsOnBoard_X.length; i++){
                    Board[FilledPositionsOnBoard_Y[i]][FilledPositionsOnBoard_X[i]] = 1;
                }
                //rysowanie kwadratu
                for(let i = 0; i < 4; i++){
                    Board[SquareY[i]][SquareX[i]] = 1;
                }
                for(let i = 0; i < 4; i++){
                    SquareY[i] += 1;
                }
                for(let i = 0; i < FilledPositionsOnBoard_X.length; i++){
                    if(SquareY[3] + 1 == FilledPositionsOnBoard_Y[i] && SquareX[3] == FilledPositionsOnBoard_X[i]
                    || SquareY[2] + 1 == FilledPositionsOnBoard_Y[i] && SquareX[2] == FilledPositionsOnBoard_X[i]){
                        for(let j = 0; j < 4; j++){
                        FilledPositionsOnBoard_X.push(SquareX[j]);
                        FilledPositionsOnBoard_Y.push(SquareY[j]);
                        }
                        postawiono = 1;
                    }
                }
                if(SquareY[3] == 19 && SquareY[2] == 19){
                    for(let i = 0; i < 4; i++){
                        FilledPositionsOnBoard_X.push(SquareX[i]);
                        FilledPositionsOnBoard_Y.push(SquareY[i]);
                        postawiono = 1;
                }
                }
                if(postawiono){
                    SquareX[0] = 0;
                SquareY[0] = 0;
                SquareX[1] = 1;
                SquareY[1] = 0;
                SquareX[2] = 0;
                SquareY[2] = 1;
                SquareX[3] = 1;
                SquareY[3] = 1;
                postawiono = 0;
                }
                //rysowanie planszy
                for(let i = 0; i < 20; i++){
                    for(let j = 0; j < 20; j++){
                        output += Board[i][j] == 0 ? "X":"O";
                        Board[i][j] = 0;
                }
                output += "<br>";
                }
                document.getElementById("demo").innerHTML = output;
                output = "";
            }
        </script>
        <script>
            function KeysRegisterer(){
                document.addEventListener("keydown",function(event) {
                    if(event.key == "ArrowLeft") {
                            if(SquareX[0] > 0 && SquareX[2] > 0){
                                for(let i = 0; i < 4; i++)
                                    SquareX[i] -= 1;
                            }
                    }
                    if(event.key == "ArrowRight") {
                            if(SquareX[1] < 19 && SquareX[3] < 19){
                            for(let i = 0; i < 4; i++)
                                SquareX[i] += 1;
                            }
                    }
                });
            }
        </script>
    </head>
    <body onload="ReloadPage">
        <div id = "demo"></div>
        <script>
            setInterval(drawBoard,300);
            KeysRegisterer();
        </script>
    </body>
</html>
